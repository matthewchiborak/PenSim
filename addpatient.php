<?php // The required code for every page on the site, dbConfig connects to the database,// session stores our globals, and the if statement returns users to the login screen// if they try and access content without loggin in first.require_once('dbConfig.php');session_start();if(!isset($_SESSION['userID'])){     header('Location: login.php');}?><?php // This contains the code which gives editprofile its specific functionality.$msg = "";$patientAdded = false;$fieldsMissing = false;$passwordsMatch = true;$newPatientId = 0;$newUserId = 0;if ($_SERVER['REQUEST_METHOD'] == 'POST') {        $patientName = $_POST["patientName"];	$password = $_POST["password"];	$password2 = $_POST["password2"];	$DOB = $_POST["DOB"];	$disorder = $_POST["disorder"];	$therapistId = $_POST["TID"];		if (strlen($patientName)==0||strlen($password)==0||strlen($password2)==0||strlen($disorder)==0)	{		$fieldsMissing = true;    } 	else if($password!=$password2)	{        $passwordsMatch = false;	}	else	{		//Find new user id		$sql = 		"SELECT s.UserID			FROM systemuser s;";		        $gottenUserIds = mysqli_query($link,$sql);	        if ($gottenUserIds == false) {            $msg = "An error seemed to have occurred during the search";        }		else		{			while($row = mysqli_fetch_array($gottenUserIds))			{				$newUserId+=1;			}						//Verify using EXISTS			$verifyResult = 1;			$sql = "SELECT EXISTS (SELECT UserID FROM SystemUser WHERE UserID='$newUserId');";						do			{				$verifyResult = mysqli_query($link, $sql);				 				if($verifyResult)				{					$newUserId+=1;				}			}while($verifyResult);									//Get patient ID			$sql = 			"SELECT p.PatientID				FROM Patient p;";						$query = mysqli_query($link,$sql);					if ($query == false) {				$msg = "An error seemed to have occurred during the search";			}			else			{				while($row = mysqli_fetch_array($query))				{					$newPatientId+=1;				}								//Verify using EXISTS				$verifyResult = 1;				$sql = "SELECT EXISTS (SELECT PatientID FROM Patient WHERE PatientID='$newPatientId');";								do				{					$verifyResult = mysqli_query($link, $sql);					 					if($verifyResult)					{						$newPatientId+=1;					}				}while($verifyResult);								//Create the new user/patient				$sql = "INSERT INTO SystemUser VALUES ($newUserId, $password, $patientName);";				$today = date("Y-m-d");				if(mysqli_query($link, $sql))				{					$sql = "INSERT INTO Patient VALUES ($newPatientId, $DOB, $disorder, $therapistId, $newUserId, $today);";					if(mysqli_query($link, $sql))					{						$patientAdded = true;					}					else					{						$msg = "An error occurred when adding the patient to the patient table";					}				}				else				{					$msg = "An error occurred when adding the patient to the user table";				}			}		}	}   }?><!doctype html><html><head>	<meta charset="UTF-8">	<meta http-equiv="X-UA-Compatible" content="IE=edge" />	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">	<link rel="apple-touch-icon" href="apple-touch-icon.png">	<!-- Place favicon.ico in the root directory -->	<title>Home - Canvas - A Free Website Template by Donny Burnside</title>	<link media="all" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans:100,200,300,400,500,600,700,800,900" rel="stylesheet">	<link media="all" type="text/css" href="css/font-awesome.min.css" rel="stylesheet">	<link media="all" type="text/css" href="css/core.css" rel="stylesheet">	<link media="all" type="text/css" href="css/skins/purple.css" rel="stylesheet">	<link media="all" type="text/css" href="css/custom.css" rel="stylesheet"></head><body class="home" itemscope itemtype="http://schema.org/WebPage">	<div id="masthead">		<div id="site-header" role="banner">			<div class="container">				<div class="row">					<div id="branding">						<a class="logo" href="index.html">Welcome <?php echo $_SESSION['userName']?></a>					</div> <!-- #branding -->					<div class='btn-toolbar pull-right'>						<div class='btn-group'>						  <button type='button' class='btn btn-primary'>Button Text</button>						</div>					</div>				</div				<div class="row">					<nav id="main-menu" role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">						<ul class="horizontal-navigation">							<li class="menu-home" itemprop="url"><a href="index.php" title="Profile" itemprop="name">Profile</a></li>							<li class="menu-about active" itemprop="url"><a href="addpatient.php" title="AddPatient" itemprop="name">Add Patient</a></li>							<li class="menu-about" itemprop="url"><a href="starttreatment.php" title="StartTreatment" itemprop="name">Start Treatment</a></li>							<li class="menu-portfolio" itemprop="url"><a href="searchpatient.php" title="SearchData" itemprop="name">Search Patients</a></li>							<li class="menu-portfolio" itemprop="url"><a href="searchexercise.php" title="SearchData" itemprop="name">Search Exercises</a></li>							<li class="menu-blog" itemprop="url"><a href="editprofile.php" title="EditProfile" itemprop="name">Edit Your Profile</a></li>						</ul>					</nav> <!-- #main-menu -->				</div> <!-- .row -->			</div> <!-- .container -->		</div> <!-- #site-header -->	</div> <!-- #masthead -->	<main id="content" role="main">		<div class="section">			<div class="container">				<div class="row">					<div class="three-quarters-block">						<div class="content">												<!--Form for entering patient information-->							<?php																			echo '<h2 class="entry-title" itemprop="headline">Add Patient</h2>												<form id="form" name="frmregister" action="'.$_SERVER['PHP_SELF'].'" method="post">													<div id="block">														<i class="material-icons">account_circle</i>														Name:														<input style="width: 200px" type="text" placeholder="Patient Name" name="patientName" id="patientName" />														<br/>														<i class="material-icons">verified_user</i>														Password:														<input type="password" name="password" id="password"/>														<br/>														<i class="material-icons">verified_user</i>														Verify Password:														<input type="password" name="password2" id="password2"/>														<br/>														<i class="material-icons">verified_user</i>														Birthdate:														<input type="date" name="DOB" id="DOB">														<br/>														<i class="material-icons">verified_user</i>														Disorder:														<input type="text" name="disorder" id="disorder">														<br/>														<i class="material-icons">verified_user</i>														Therapist:														<select>';																												$sql = "SELECT t.EmployeeID FROM Therapist t";																												$employeeList = mysqli_query($link,$sql);														if ($employeeList == false) 														{															$msg = "An error seemed to have occurred during the search";														}														else														{																while($row = mysqli_fetch_array($employeeList))																{																	echo '<option name="TID" id="TID">'.$row[0].'</option>';																}														}														echo '</select>														<br/>														<input type="submit" id="submit" name="submit" value="Go"/>';																												if($msg != "")															echo "<br/><p>".$msg."</p>";																										echo '</div>												</form>';									if($patientAdded)									{										echo '<h2>Patient Added Successfully</h2>';									}									else if($fieldsMissing)									{										echo '<h2>Fields were left blank. Could not add new patient</h2>';									}									else if(!$passwordsMatch)									{										echo '<h2>The entered passwords did not match. Could not add new patient</h2>';									}								?>																	<article class="post hentry" itemscope itemprop="blogPost" itemtype="http://schema.org/Article">								<header class="entry-header">									<h2 class="entry-title" itemprop="headline">Lorem ipsum dolor sit amet</h2>																									<div class="entry-meta">										<span class="post-date">											<i class="fa fa-clock-o fa-fw"></i> <span class="updated">12th February 2015</span>										</span> <!-- .post-date -->										<span class="post-author">											<i class="fa fa-user fa-fw"></i> Written by <span class="vcard"><a class="fn url" href="author.html">Author</a></span>										</span> <!-- .post-author -->										<span class="post-categories">											<i class="fa fa-folder fa-fw"></i> <a href="blog.html" rel="tag">Category A</a>, <a href="blog.html" rel="tag">Category B</a>										</span> <!-- .post-categories -->										<span class="post-tags">											<i class="fa fa-tags fa-fw"></i> <a href="blog.html" rel="tag">Tag A</a>, <a href="blog.html" rel="tag">Tag B</a>, <a href="blog.html" rel="tag">Tag C</a>										</span> <!-- .post-tags -->									</div> <!-- .entry-meta -->								</header> <!-- .entry-header -->								<div class="entry-image">									<img src="http://dummyimage.com/800x250/f3f3f3/d1d1d1.jpg&text=Featured+Image" alt="Featured Image" itemprop="image">								</div> <!-- .entry-image -->								<div class="entry-content" itemprop="articleBody">									<p>Lorem ipsum dolor sit amet, orci a faucibus, ante curabitur augue ornare nulla facilisi bibendum, tortor felis quam rutrum velit, pretium posuere placerat. Vitae ut nulla eget. Lacus sociis, eget dolor metus nam nunc leo. Tempor eget donec officia. Luctus nullam purus urna iaculis, integer dui risus, ultricies lacinia aliquet.</p>									<p>Lorem ipsum dolor sit amet, orci a faucibus, ante curabitur augue ornare nulla facilisi bibendum, tortor felis quam rutrum velit, pretium posuere placerat. Vitae ut nulla eget. Lacus sociis, eget dolor metus nam nunc leo. Tempor eget donec officia. Luctus nullam purus urna iaculis, integer dui risus, ultricies lacinia aliquet.</p>									<p>Lorem ipsum dolor sit amet, orci a faucibus, ante curabitur augue ornare nulla facilisi bibendum, tortor felis quam rutrum velit, pretium posuere placerat. Vitae ut nulla eget. Lacus sociis, eget dolor metus nam nunc leo. Tempor eget donec officia. Luctus nullam purus urna iaculis, integer dui risus, ultricies lacinia aliquet.</p>								</div> <!-- .entry-content -->							</article> <!-- .post -->						</div> <!-- .content -->					</div> <!-- .three-quarters-block -->										<div class="one-quarter-block" role="complementary">						<div class="sidebar">							<div class="search-widget widget">								<form class="widget-form" action="#" method="get" role="search">									<label>										<span class="screen-reader-text">Search this website:</span>										<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="search" title="Search" />									</label>									<button><i class="fa fa-search"></i></button>								</form>							</div> <!-- .search.widget -->						</div> <!-- .sidebar -->					</div> <!-- .one-quarter-block -->				</div> <!-- .row -->			</div> <!-- .container -->		</div> <!-- .section -->	</main> <!-- #content -->		<footer id="footer" role="contentinfo">		<div class="container">			<div class="row">				<div class="copyright">&copy; UWO, SE 3313 2015</div>							</div> <!-- .row -->		</div> <!-- .container -->	</footer> <!-- #footer --></body></html>